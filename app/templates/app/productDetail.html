{% extends "app/base.html" %}
{% load static %}

{% block body_content %}
    <div class="bg-base-100">
    <!-- Breadcrumb -->
        <div class="px-4 py-4 text-sm">
            <div class="max-w-7xl mx-auto">
                <a href="{% url 'index' %}" class="link link-neutral">Home</a>
                <span class="mx-2">/</span>
                <a href="{% url 'products' %}" class="link link-neutral">Products</a>
                <span class="mx-2">/</span>
                <span class="text-gray-500">{{ product.name }}</span>
            </div>
        </div>

    <!-- Product Detail -->
        <div class="px-4 py-12 bg-base-100">
            <div class="max-w-7xl mx-auto">
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-12">
                <!-- Product Image Gallery -->
                    <div class="space-y-4">
                        <!-- Main Image -->
                        <div class="flex items-center justify-center bg-gray-100 rounded-lg overflow-hidden">
                            <img
                                id="mainProductImage"
                                src="{{ product.variants.first.image.url }}"
                                alt="{{ product.name }}"
                                class="w-full h-auto rounded-lg shadow-lg object-cover"
                            />
                        </div>
                        
                        <!-- Thumbnail Gallery -->
                        {% if product.variants.count > 1 %}
                        <div class="grid grid-cols-4 gap-3">
                            {% for variant in product.variants.all %}
                            <div class="thumbnail-item cursor-pointer border-2 rounded-lg overflow-hidden transition-all {% if forloop.first %}border-success{% else %}border-gray-300 hover:border-gray-400{% endif %}"
                                 data-image="{{ variant.image.url }}"
                                 data-price="{{ variant.price }}"
                                 data-stock="{{ variant.stock }}"    >                           
                                <img src="{{ variant.image.url }}" 
                                     alt="{{ product.name }}" 
                                     class="w-full h-32 object-cover aspect-square">
                            </div>
                            {% endfor %}
                        </div>
                        {% endif %}
                    </div>

                <!-- Product Info -->
                    <div class="space-y-6">
                    
                    <!-- Category -->
                        <div>
                            <p class="text-gray-600">
                                <span class="font-semibold">Category:</span>
                                <a href="{% url 'products-by-category' product.category.id %}" class="link link-primary">{{ product.category.name }}</a>
                            </p>
                        </div>

                        <!-- Title -->
                        <div>
                            <h1 class="text-3xl text-gray-900">{{ product.name }}</h1>
                        </div>
                        
                    <!-- Price -->
                        <div class="space-y-2">
                            <div class="flex items-center ">
                                <span class="text-3xl font-bold text-gray-900">Rs.<span id="selectedPriceValue">{{ product.variants.first.price }}</span></span>
                            </div>
                        </div>

                        <!-- Stock Status -->
                        <div>
                            <p class="text-sm text-gray-600">
                                <span class="inline-flex items-center gap-2">
                                    <span class="w-3 h-3 rounded-full {% if product.variants.first.is_in_stock %}bg-green-500 animate-pulse shadow-lg shadow-green-500{% else %}bg-red-500{% endif %}"></span>
                                    <span id="stockStatus">
                                        {% if product.variants.first.is_in_stock %}In Stock ({{ product.variants.first.stock }} available){% else %}Out of Stock{% endif %}
                                    </span>
                                </span>
                                
                            </p>
                        </div>

                    <!-- Description -->
                    {% if product.description %}
                    <div class="collapse collapse-plus bg-base-100 border border-base-300" id="descriptionCollapse">
                        <input type="radio" name="my-accordion-3" />
                        <div class="collapse-title font-semibold">Description</div>
                        <div class="collapse-content text-sm">{{ product.description }}</div>
                    </div>
                    {% endif %}
                      
                        
                    <!-- Add to Cart Button -->
                        <div class="pt-6">
                            <button class="btn btn-success btn-lg w-full" 
                                    id="addToCartButton" 
                                    data-product-id="{{ product.pk }}"
                                    data-variant-id="{{ product.variants.first.id }}"
                                    {% if not product.variants.first.is_in_stock %}disabled{% endif %}>
                                {% if product.variants.first.is_in_stock %}Add to Cart{% else %}Out of Stock{% endif %}
                            </button>
                        </div>
                    <!-- Order Via Whatsapp Button -->
                        <div>
                            <button class="btn btn-success btn-lg w-full" 
                                    id="orderWhatsappButton" 
                                    data-product-id="{{ product.pk }}"
                                    data-variant-id="{{ product.variants.first.id }}"
                                    {% if not product.variants.first.is_in_stock %}disabled{% endif %}>
                                {% if product.variants.first.is_in_stock %}Order On Whatsapp{% else %}Out of Stock{% endif %}
                            </button>
                        </div>
                        
                    
                    </div>
                </div>
            </div>
        </div>
    </div>
{% endblock body_content %}
